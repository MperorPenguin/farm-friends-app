/* ===============================
   Farm Friends – Stylesheet
   Version: v0.4.3-beta
   - Feed uses image-based food choices
   - Keeps previous animations & feedback
   =============================== */

:root{
  --brand-brown:  #3a2a1f;
  --brand-cream:  #fff4e3;
  --brand-yellow: #f3c64e;
  --brand-orange: #f29b38;
  --brand-green:  #86c56a;
  --brand-red:    #e5644a;

  --text: #2d2a28;
  --card: var(--brand-cream);
  --card-border: #e5dccd;

  --focus: #5aaef7;

  --brand-bg-url: url('assets/brand/background.png');
  --bg-overlay: rgba(255,255,255,0.55);
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  position:relative; min-height:100%;
  color:var(--text);
  font-family: "Baloo 2", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background-image: var(--brand-bg-url);
  background-size: cover; background-position: center; background-repeat: no-repeat;
  overflow-x:hidden;
}

body::before{
  content:""; position:fixed; inset:0; z-index:0; pointer-events:none;
  background: var(--bg-overlay);
  backdrop-filter: saturate(110%) blur(0.5px);
}

/* Section-specific tints */
body.route-home   { --bg-overlay: rgba(255,255,240,0.55); }
body.route-explore{ --bg-overlay: rgba(255,255,255,0.62); }
body.route-match  { --bg-overlay: rgba(0,0,0,0.25); }
body.route-feed   { --bg-overlay: rgba(0,0,0,0.18); }

#home, main#app, .scene, .match, .feed { position:relative; z-index:1; }

/* Back button */
.btn-back{
  position:fixed; left:12px; top:calc(12px + env(safe-area-inset-top)); z-index:20;
  padding:.7rem 1.1rem; border-radius:999px; border:3px solid var(--brand-brown);
  background:#fff; color:var(--brand-brown); box-shadow:0 8px 20px rgba(0,0,0,.18);
  font-weight:900;
}
.btn-back.hidden{ display:none; }

/* Logo */
.logo-img{
  max-width: 380px; width: clamp(220px, 60vw, 380px);
  height:auto; display:block; margin:0 auto 0.75rem;
  filter: drop-shadow(0 8px 20px rgba(0,0,0,.18));
}

/* Home */
.home{
  min-height: 100dvh;
  padding: max(1rem, env(safe-area-inset-top)) 1rem max(1rem, env(safe-area-inset-bottom));
  display:flex; justify-content:center; align-items:center;
  overflow:auto;
}
.home-inner{ width:min(1100px,96vw); display:grid; gap:1.2rem; }
.brand{ text-align:center; }

.menu{
  display:grid; gap:1rem;
  grid-template-columns: repeat(auto-fit, minmax(280px,1fr));
}
.menu-card{
  display:grid; grid-template-columns: auto 1fr; align-items:center; gap:.9rem;
  padding:1rem 1.1rem; border-radius: 28px; border:3px solid #0000;
  background: linear-gradient(140deg, #ffffffcc, #fff);
  box-shadow: 0 12px 24px rgba(0,0,0,.16);
  cursor:pointer; transition: transform .12s ease, box-shadow .15s ease, border-color .15s ease, filter .15s ease;
  position:relative; overflow:visible;
}
.menu-card img{ width:86px; height:auto; }
.menu-card .title{ font-weight:900; font-size: clamp(1.2rem, 3.4vw, 1.5rem); color: var(--brand-brown);}
.menu-card .subtitle{ font-size: clamp(.95rem, 2.6vw, 1.05rem); opacity:.95; }
.menu-card:hover, .menu-card:focus-visible{
  transform: translateY(-2px) scale(1.01);
  box-shadow: 0 18px 32px rgba(0,0,0,.22);
  border-color: #00000014; filter: saturate(1.03);
}
.menu-card:active{ transform: translateY(1px) scale(.99); }
.menu-card.disabled{ opacity:.55; cursor:not-allowed; filter: grayscale(.05); }

/* Menu puff */
.menu-burst{ position:absolute; inset:0; pointer-events:none; }
.menu-spark{
  --x:0; --y:0; --tx:0; --ty:-40px; --d:600ms; --sz:10px;
  position:absolute; left:var(--x); top:var(--y);
  width:var(--sz); height:var(--sz); border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #ffd166 30%, #f4978e 60%, #bee3db 100%);
  opacity:.9; transform:translate(0,0);
  animation: menu-spark-move var(--d) ease-out forwards;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,.2));
}
@keyframes menu-spark-move{ 0%{opacity:0; transform:translate(0,0) scale(.6)} 10%{opacity:1} 100%{opacity:0; transform:translate(var(--tx), var(--ty)) scale(1.15)} }

/* Buttons */
.btn{
  font-size: 1rem; padding: .85rem 1.2rem; border-radius: 999px;
  border: 0; cursor:pointer; transition: transform .06s ease, filter .2s ease, box-shadow .2s ease;
  box-shadow: 0 6px 16px rgba(0,0,0,.16);
}
.btn:focus-visible{ outline:3px solid var(--focus); outline-offset:2px; }
.btn:active{ transform: translateY(1px) scale(.985); }
.btn-hero{
  display:inline-flex; align-items:center; gap:.5rem; font-weight:900; letter-spacing:.2px; color:#fff;
  background: linear-gradient(135deg, var(--brand-green), #6fb85a 60%, #5aa44c);
}
.btn-hero:hover{ filter: saturate(1.06) brightness(1.02); }
.btn-orange{ background: linear-gradient(135deg, var(--brand-orange), #e0872f 60%, #cc792a); color:#fff; }
.btn-cream{ background: #fff; color: var(--brand-brown); border:2px solid var(--brand-brown); }
.btn-lg{ font-size:1.1rem; padding:1rem 1.35rem; border-radius:999px; }
.btn-ico svg{ display:block }

/* Explore grid */
.scene{
  min-height: 100dvh;
  padding: max(1rem, env(safe-area-inset-top)) 1rem max(1rem, env(safe-area-inset-bottom));
  display:grid; gap:1rem; place-content:center; justify-items:center;
  grid-template-columns: repeat(2, minmax(0,1fr));
  overflow:auto;
}
@media (min-width:600px){ .scene{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
@media (min-width:900px){ .scene{ grid-template-columns: repeat(4, minmax(0,1fr)); } }

.animal{
  position:relative; background: var(--card); border-radius: 28px; border:3px solid var(--brand-brown);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:.9rem; width:100%; max-width:280px; aspect-ratio:1/1; cursor:pointer;
  box-shadow: 0 12px 22px rgba(0,0,0,.16); overflow:visible; isolation:isolate;
  transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
}
.animal img{ width:88%; max-width:220px; height:auto; pointer-events:none; user-select:none; }
.animal-name{ font-size:1.05rem; font-weight:900; margin-top:.5rem; letter-spacing:.2px; color: var(--brand-brown); }
.animal:hover, .animal:focus-visible{
  animation: wobble .45s ease-in-out 1;
  box-shadow: 0 18px 30px rgba(0,0,0,.22);
  transform: translateY(-2px) scale(1.02);
}
@keyframes wobble{ 0%{transform:rotate(0) scale(1)} 25%{transform:rotate(1.25deg) scale(1.02)} 50%{transform:rotate(0) scale(1.03)} 75%{transform:rotate(-1.25deg) scale(1.02)} 100%{transform:rotate(0) scale(1)} }
.animal.selected{ filter:saturate(1.08) brightness(1.02); }
@keyframes pop{0%{transform:scale(1)}60%{transform:scale(1.08)}100%{transform:scale(1)}}
.animal.pop{animation: pop .22s ease-out;}
.burst{position:absolute; inset:0; pointer-events:none; overflow:visible;}
.spark{
  --x:0; --y:0; --tx:0; --ty:-40px; --d:600ms; --sz:10px;
  position:absolute; left:var(--x); top:var(--y);
  width:var(--sz); height:var(--sz); border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #ffd166 30%, #f4978e 60%, #bee3db 100%);
  opacity:.9; transform:translate(0,0);
  animation:spark-move var(--d) ease-out forwards;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,.2));
}
@keyframes spark-move{ 0%{opacity:0; transform:translate(0,0) scale(.6)} 10%{opacity:1} 100%{opacity:0; transform:translate(var(--tx), var(--ty)) scale(1.1)} }

/* Modal */
.overlay{
  position:fixed; inset:0; background: rgba(0,0,0,.35);
  display:grid; place-items:center; z-index:100; backdrop-filter: blur(4px); transition: opacity .2s ease;
}
.overlay.hidden{ display:none; }
.overlay.closing{ animation: overlay-out .2s ease forwards; }
@keyframes overlay-out{ to{opacity:0} }

.modal{
  width:min(1100px,96vw); max-height: 88dvh; overflow:auto;
  background:#fff; border-radius: 28px; border:4px solid var(--brand-brown);
  box-shadow: 0 20px 40px rgba(0,0,0,.25); padding:1.1rem; position:relative; animation: modal-in .2s ease both;
}
@keyframes modal-in{ from{transform:scale(.95); opacity:0} to{transform:scale(1); opacity:1} }
.overlay.closing .modal{ animation: modal-out .2s ease forwards; }
@keyframes modal-out{ to{transform:scale(.94); opacity:0} }

.modal-body{ display:grid; grid-template-columns: 1fr 1.5fr; gap:1rem; align-items:center; }
@media (max-width: 720px){ .modal-body{ grid-template-columns:1fr } .modal{ padding:.9rem } }
.modal-image-wrap{ display:grid; place-items:center; gap:.5rem; }
#modal-img{ width:min(480px,78vw); height:auto; max-height: 40dvh; object-fit:contain; }
.modal-content h2{ margin:0 0 .5rem 0; font-size:1.9rem; color:var(--brand-brown); }
.facts{ display:grid; grid-template-columns:1fr; gap:.5rem; }
.facts dt{ font-weight:800; margin-bottom:.15rem; font-size:1.05rem; color:#5a554f; }
.facts dd{ margin:0 0 .35rem 0; font-size:1.15rem; line-height:1.35; }

body.modal-open #home, body.modal-open main#app{ filter: blur(3px) brightness(.92); }
body.modal-open{ overflow:hidden; }

.modal-close, #modal-close{
  position:absolute; top:calc(10px + env(safe-area-inset-top)); right:10px;
  width:64px; height:64px; border-radius:50%;
  border:3px solid var(--brand-brown);
  background:#fff; color: var(--brand-brown);
  font-size:32px; line-height:58px; cursor:pointer;
  box-shadow:0 10px 20px rgba(0,0,0,.18);
}

/* Guess the Sound */
.match{
  min-height: 100dvh;
  padding: max(1rem, env(safe-area-inset-top)) 1rem max(1rem, env(safe-area-inset-bottom));
  display:grid; place-items:center; overflow:auto;
}
.match-card{
  width:min(820px,100%); background:#fff; border-radius: 28px;
  border:4px solid var(--brand-brown);
  box-shadow: 0 14px 28px rgba(0,0,0,.2); padding:1.2rem;
  transition: transform .2s ease, opacity .2s ease;
}
.prompt{ display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem; }
.prompt-text{ font-size:1.35rem; font-weight:900; letter-spacing:.2px; color: var(--brand-brown); }
.choices{ display:grid; grid-template-columns: repeat(auto-fit, minmax(160px,1fr)); gap:1rem; }
.choice{
  background:#fff; border:3px solid var(--brand-brown); border-radius: 26px;
  padding:.7rem; display:flex; flex-direction:column; align-items:center; justify-content:center;
  min-height:180px; cursor:pointer; box-shadow:0 10px 18px rgba(0,0,0,.16);
  transition: transform .1s ease, filter .12s ease;
}
.choice img{ width:90%; height:auto; }
.choice:hover{ transform: translateY(-2px) scale(1.02); }
.choice.correct{ border-color: var(--brand-green); box-shadow: 0 0 0 6px rgba(134,197,106,.18), 0 8px 18px rgba(0,0,0,.18); }
.choice.incorrect{ border-color: var(--brand-red); box-shadow: 0 0 0 6px rgba(229,100,74,.18), 0 8px 18px rgba(0,0,0,.18); }
.result{ min-height:2rem; display:grid; place-items:center; font-weight:800; margin-top:.75rem; color: var(--brand-brown); }
.match-card.swap-out{ opacity:0; transform: scale(.98); }
.match-card.swap-in{ opacity:1; transform: scale(1); }

/* Feed the Animal */
.feed{
  min-height: 100dvh;
  padding: max(1rem, env(safe-area-inset-top)) 1rem max(1rem, env(safe-area-inset-bottom));
  display:grid; place-items:center; overflow:auto;
}
.feed-card{
  width:min(860px,100%); background:#fff; border-radius: 28px;
  border:4px solid var(--brand-brown);
  box-shadow: 0 14px 28px rgba(0,0,0,.2); padding:1.2rem; position:relative;
}
.feed-top{
  display:flex; align-items:center; justify-content:space-between; gap:1rem; margin-bottom:1rem;
}
.feed-animal{ display:flex; align-items:center; gap:.9rem; }
#feed-img{ width:min(240px,42vw); height:auto; object-fit:contain; }
.feed-name{ font-size:1.6rem; font-weight:900; color: var(--brand-brown); }

.feed-prompt{
  font-size:1.35rem; font-weight:900; letter-spacing:.2px; color: var(--brand-brown);
  margin:.25rem 0 1rem; opacity:0; transform: translateY(8px);
}
.food-choices{
  display:grid; grid-template-columns: repeat(auto-fit, minmax(170px,1fr)); gap:1rem;
  opacity:0; transform: translateY(12px);
}
.food-choice{
  background:#fff;
  border:3px solid var(--brand-brown);
  border-radius: 26px;
  padding:.95rem;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:.6rem;
  min-height:180px;
  cursor:pointer;
  box-shadow:0 10px 18px rgba(0,0,0,.16);
  transition: transform .1s ease, filter .12s ease;
  font-size:1.12rem;
  font-weight:800;
  color: var(--brand-brown);
}
.food-choice img.food-img {
  width: 100px;
  height: auto;
  object-fit: contain;
}
.food-choice:hover{ transform: translateY(-2px) scale(1.02); }
.food-choice.correct{ border-color: var(--brand-green); box-shadow: 0 0 0 6px rgba(134,197,106,.18), 0 8px 18px rgba(0,0,0,.18); }
.food-choice.incorrect{ border-color: var(--brand-red); box-shadow: 0 0 0 6px rgba(229,100,74,.18), 0 8px 18px rgba(0,0,0,.18); }

/* Feed entrance sequence */
.feed-card.entering #feed-img{ animation: animal-walk-in .5s ease-out both; }
.feed-card.entering .feed-name{ animation: fade-in-up .35s .2s ease-out both; }
.feed-card.focused #feed-img{ animation: animal-focus .35s ease-out both; }
.feed-card.show-choices .feed-prompt{ animation: fade-in-up .35s ease-out both; }
.feed-card.show-choices .food-choices{ animation: fade-in-up .45s .1s ease-out both; }

@keyframes animal-walk-in{
  from{ transform: translateX(-18px) scale(.98) rotate(-1.5deg); opacity:0 }
  to{ transform: translateX(0) scale(1) rotate(0); opacity:1 }
}
@keyframes animal-focus{
  from{ transform: scale(1) }
  to{ transform: scale(1.05) }
}
@keyframes fade-in-up{
  from{ opacity:0; transform: translateY(10px) }
  to{ opacity:1; transform: translateY(0) }
}

/* Feedback popup – bigger, rounder, readable */
.feedback-overlay{
  position:fixed; inset:0; z-index:200; display:grid; place-items:center;
  background: rgba(0,0,0,.32); backdrop-filter: blur(2px);
}
.feedback-overlay.hidden{ display:none; }
.feedback-card{
  width:min(760px, 94vw); border-radius: 32px; padding:1.25rem;
  border:4px solid var(--brand-brown); background:#fff; box-shadow: 0 18px 36px rgba(0,0,0,.3);
  animation: fb-in .22s ease both; max-height: 88dvh; overflow:auto;
}
.feedback-card.out{ animation: fb-out .18s ease both; }
@keyframes fb-in{ from{transform:scale(.95); opacity:0} to{transform:scale(1); opacity:1} }
@keyframes fb-out{ to{transform:scale(.94); opacity:0} }
.fb-title{
  font-size: clamp(1.6rem, 4.2vw, 2rem);
  font-weight:900; margin:.2rem 0; color: var(--brand-brown); letter-spacing:.2px;
}
.fb-message{
  font-size: clamp(1.15rem, 3.4vw, 1.3rem);
  line-height:1.5; margin:.35rem 0 .9rem; color:#4b443d;
}
.fb-actions{ display:flex; gap:.7rem; justify-content:flex-end; flex-wrap:wrap; }
.feedback-overlay.correct #fb-primary.btn-hero{ background: linear-gradient(135deg, var(--brand-green), #6fb85a 60%, #5aa44c); }
.feedback-overlay.incorrect #fb-secondary.btn-hero{ background: linear-gradient(135deg, var(--brand-orange), #e0872f 60%, #cc792a); }

/* Confetti for correct answers */
.feedback-overlay.correct .feedback-card{
  position:relative;
  box-shadow: 0 0 0 6px rgba(134,197,106,.18), 0 20px 36px rgba(0,0,0,.28);
}
.confetti{
  position:absolute; inset:0; pointer-events:none;
}
.confetti i{
  --x: 0; --y: 0; --tx: 0; --ty: -60px; --d: 800ms; --sz: 10px;
  position:absolute; left:var(--x); top:var(--y);
  width:var(--sz); height:var(--sz); border-radius:4px;
  background: conic-gradient(#ffd166, #f4978e, #bee3db, #f3c64e);
  opacity:.95; transform:translate(0,0) rotate(0deg);
  animation: confetti-pop var(--d) ease-out forwards;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,.18));
}
@keyframes confetti-pop{
  0%{ opacity:0; transform: translate(0,0) rotate(0deg) }
  10%{ opacity:1 }
  100%{ opacity:0; transform: translate(var(--tx), var(--ty)) rotate(140deg) }
}

/* Utilities */
.hidden{ display:none !important; }

@media (max-width:480px){
  .animal{ min-height:140px }
  .animal-name{ font-size:1rem }
  .prompt-text, .feed-prompt{ font-size:1.15rem }
  .btn-lg{ font-size:1.05rem; padding:.9rem 1.1rem; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .animal, .choice, .menu-card, .match-card, .feed-card, .feedback-card{ animation:none !important; transition:none !important; }
  .feed-card.entering #feed-img,
  .feed-card.focused #feed-img,
  .feed-card.show-choices .feed-prompt,
  .feed-card.show-choices .food-choices { animation: none !important; opacity: 1 !important; transform: none !important; }
}
/* FEED: harden visibility when show-choices is set */
.feed-card.show-choices .feed-prompt,
.feed-card.show-choices .food-choices {
  opacity: 1 !important;
  transform: none !important;
}
/* FEED: harden visibility when show-choices is set */
.feed-card.show-choices .feed-prompt,
.feed-card.show-choices .food-choices {
  opacity: 1 !important;
  transform: none !important;
}


